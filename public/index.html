<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>PaseoLibros</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fuente Google bonita y juvenil -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <!-- CSS propio -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="logo">
        <div class="logo-icon">
          <span class="logo-mark">Pdl</span>
        </div>
        <div class="logo-text">
          <h1>Paseo de los libros</h1>
          <p>Biblioteca, lecturas, pr√©stamos...</p>
        </div>
      </div>
    </header>

    <main class="app-main">
      <!-- COLUMNA IZQUIERDA: LOGIN + ALTA DE EJEMPLARES -->
      <section class="column column-left">
        <!-- Autenticaci√≥n -->
        <div class="card">
          <h2>Autenticaci√≥n</h2>

          <div id="zona-no-autenticado">
            <div class="form-grid">
              <div class="form-group">
                <label for="login-usuario">Usuario</label>
                <input id="login-usuario" placeholder="Tu usuario" />
              </div>

              <div class="form-group">
                <label for="login-contrasena">Contrase√±a</label>
                <input
                  id="login-contrasena"
                  type="password"
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                />
              </div>
            </div>

            <button id="btn-login" class="btn btn-primary btn-full">
              Iniciar sesi√≥n
            </button>
            <p id="login-mensaje" class="helper-text"></p>
          </div>

          <div id="zona-autenticado" style="display:none;">
            <div class="user-pill">
              <span class="user-avatar">üë§</span>
              <div>
                <p class="user-label">Sesi√≥n iniciada como</p>
                <p class="user-name">
                  <strong id="nombre-usuario-actual"></strong>
                </p>
              </div>
            </div>
            <button id="btn-logout" class="btn btn-ghost btn-full">
              Cerrar sesi√≥n
            </button>
          </div>
        </div>

        <!-- Alta de ejemplares -->
        <div class="card">
          <h2>A√±adir ejemplar por ISBN</h2>          
          <div class="form-group">
            <label for="isbn">ISBN</label>
            <div class="input-with-button">
              <input
                type="text"
                id="isbn"
                placeholder="Escanea o escribe el c√≥digo ISBN"
              />
              <button id="btn-escanear" class="btn btn-secondary">
                Escanear
              </button>
            </div>
          </div>

          <div
            id="scanner"
            class="scanner"
            style="display:none;"
          >
            <p class="scanner-text">
              Apunta la c√°mara al c√≥digo de barras del libro
            </p>
            <video
              id="video"
              width="320"
              height="200"
              class="scanner-video"
            ></video>
            <button id="btn-detener" class="btn btn-ghost btn-full">
              Detener escaneo
            </button>
          </div>

          <div class="form-group">
            <label for="ubicacion">Ubicaci√≥n</label>
            <input
              type="text"
              id="ubicacion"
              placeholder="Ej: Sal√≥n - Estanter√≠a 1"
            />
          </div>

          <div class="form-group">
            <label for="notas">Notas</label>
            <input
              type="text"
              id="notas"
              placeholder="Comentario opcional"
            />
          </div>

          <button id="btn-crear" class="btn btn-primary btn-full">
            Crear ejemplar
          </button>
        </div>
      </section>

      <!-- COLUMNA DERECHA: EJEMPLARES + LECTURAS + PR√âSTAMOS -->
      <section class="column column-right">
        <!-- Ejemplares -->
        <div class="card">
          <div class="card-header card-header-inline">
            <h2>Ejemplares</h2>
            <div class="table-search">
              <input
                id="buscador-ejemplares"
                type="text"
                placeholder="Buscar por t√≠tulo, autor, ISBN, notas..."
              />
            </div>
          </div>
          <p id="info-ejemplares" class="helper-text">
            Inicia sesi√≥n para ver tu biblioteca.
          </p>
          <div class="table-wrapper">
            <table id="tabla-ejemplares" class="table">
              <thead>
                <tr>
                  <th>Portada</th>
                  <th>T√≠tulo</th>
                  <th>Autor/es</th>
                  <th>ISBN</th>
                  <th>Estado</th>
                  <th>Ubicaci√≥n</th>
                  <th>Notas</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <!-- Rellenado por JS -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Resumen de lecturas y pr√©stamos abiertos -->
        <div class="grid-two">
          <!-- Lecturas en curso -->
          <div class="card card-inside-modal">
            <div class="card-header-inline">
              <h2>Lecturas en curso</h2>
            </div>
            <p id="info-lecturas-abiertas" class="helper-text">
              Inicia sesi√≥n para ver tus lecturas en curso.
            </p>
            <div class="table-wrapper">
              <table
                id="tabla-lecturas-abiertas"
                class="table table-small"
              >
                <thead>
                  <tr>
                    <th>Libro</th>
                    <th>P√°gina</th>
                    <th>Inicio</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Rellenado por JS -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Pr√©stamos activos -->
          <div class="card card-inside-modal">
            <div class="card-header-inline">
              <h2>Pr√©stamos activos</h2>
            </div>
            <p id="info-prestamos-activos" class="helper-text">
              Inicia sesi√≥n para ver tus pr√©stamos activos.
            </p>
            <div class="table-wrapper">
              <table
                id="tabla-prestamos-activos"
                class="table table-small"
              >
                <thead>
                  <tr>
                    <th>Libro</th>
                    <th>A qui√©n</th>
                    <th>Hasta</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Rellenado por JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <p>¬°Ub√≠cate!</p>
    </footer>
  </div>

  <!-- Librer√≠a ZXing y JS de la app -->
  <script src="https://unpkg.com/@zxing/library@latest"></script>
  <script src="main.js"></script>

  <!-- Modal ficha libro/ejemplar -->
  <div id="modal-ficha" class="modal">
    <div id="modal-ficha-backdrop" class="modal-backdrop"></div>

    <div class="modal-dialog">
      <button id="modal-ficha-cerrar" class="modal-close">&times;</button>

      <!-- Cabecera de la ficha -->
      <div class="modal-header">
        <div class="modal-cover">
          <img
            id="ficha-portada-img"
            src=""
            alt="Portada del libro"
            class="modal-cover-img"
          />
          <label class="btn btn-secondary btn-sm modal-cover-upload">
            Subir portada
            <input
              type="file"
              id="ficha-portada-file"
              accept="image/*"
              hidden
            />
          </label>
        </div>

        <div class="modal-header-info">
          <h2 id="ficha-titulo">T√≠tulo del libro</h2>
          <p id="ficha-autores" class="helper-text">Autor/es</p>
          <p class="helper-text">
            ISBN: <span id="ficha-isbn">‚Äî</span>
          </p>
          <p class="helper-text">
            Incorporado a tu biblioteca:
            <span id="ficha-creado-en">‚Äî</span>
          </p>
        </div>
      </div>

      <!-- Cuerpo de la ficha -->
      <div class="modal-body">
        <!-- Datos del libro (reutilizamos los mismos IDs que antes) -->
        <div class="form-subsection">
          <h3>Datos del libro</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="edit-libro-titulo">T√≠tulo</label>
              <input id="edit-libro-titulo" type="text" />
            </div>
            <div class="form-group">
              <label for="edit-libro-autores">Autor/es</label>
              <input id="edit-libro-autores" type="text" />
            </div>
            <div class="form-group">
              <label for="edit-libro-editorial">Editorial</label>
              <input id="edit-libro-editorial" type="text" />
            </div>
            <div class="form-group">
              <label for="edit-libro-fecha">Fecha publicaci√≥n</label>
              <input
                id="edit-libro-fecha"
                type="text"
                placeholder="Ej: 1960"
              />
            </div>
            <div class="form-group">
              <label for="edit-libro-paginas">N¬∫ p√°ginas</label>
              <input id="edit-libro-paginas" type="number" min="1" />
            </div>
            <div class="form-group">
              <label for="edit-libro-portada">URL portada</label>
              <input id="edit-libro-portada" type="text" />
            </div>
          </div>

          <div class="form-group">
            <label for="edit-libro-descripcion">Descripci√≥n</label>
            <textarea id="edit-libro-descripcion" rows="3"></textarea>
          </div>

          <button id="btn-guardar-libro" class="btn btn-primary btn-full">
            Guardar datos del libro
          </button>
        </div>

        <hr class="divider" />

        <!-- Datos del ejemplar -->
        <div class="form-subsection">
          <h3>Datos del ejemplar</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="edit-ejemplar-estado">Estado</label>
              <input
                id="edit-ejemplar-estado"
                type="text"
                placeholder="propio, prestado, etc."
              />
            </div>
            <div class="form-group">
              <label for="edit-ejemplar-ubicacion">Ubicaci√≥n</label>
              <input id="edit-ejemplar-ubicacion" type="text" />
            </div>
          </div>
          <div class="form-group">
            <label for="edit-ejemplar-notas">Notas</label>
            <input id="edit-ejemplar-notas" type="text" />
          </div>

          <button id="btn-guardar-ejemplar" class="btn btn-secondary btn-full">
            Guardar datos del ejemplar
          </button>
        </div>

        <p id="edit-mensaje" class="helper-text"></p>

        <hr class="divider" />

        <!-- Lecturas y pr√©stamos dentro del modal -->
        <div class="grid-two">
          <!-- Lecturas -->
          <div class="card card-inside-modal card-summary">
            <div class="card-header-inline">
              <h3>Lecturas del libro</h3>
              <div class="card-header-actions">
                <button id="btn-ver-lecturas" class="btn btn-ghost btn-sm">
                  Ver lecturas
                </button>
                <button
                  id="btn-terminar-lectura"
                  class="btn btn-secondary btn-sm"
                >
                  Terminar lectura
                </button>
              </div>
            </div>
            <p id="info-lecturas" class="helper-text">
              Selecciona un ejemplar en la tabla para ver o terminar tu lectura.
            </p>
            <pre id="lecturas-detalle" class="result-block small"></pre>
          </div>

          <!-- Pr√©stamos -->
          <div class="card card-inside-modal card-summary">
            <div class="card-header-inline">
              <h3>Pr√©stamos del libro</h3>
              <div class="card-header-actions">
                <button id="btn-ver-prestamos" class="btn btn-ghost btn-sm">
                  Ver pr√©stamos
                </button>
                <button
                  id="btn-marcar-devuelto-global"
                  class="btn btn-secondary btn-sm"
                >
                  Marcar devuelto
                </button>
              </div>
            </div>
            <p id="info-prestamos" class="helper-text">
              Selecciona un ejemplar en la tabla para ver o cerrar pr√©stamos.
            </p>
            <div class="table-wrapper">
              <table id="tabla-prestamos" class="table table-small">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Prestador</th>
                    <th>Receptor</th>
                    <th>Fecha pr√©stamo</th>
                    <th>Fecha l√≠mite</th>
                    <th>Fecha devoluci√≥n</th>
                    <th>Estado</th>
                    <th>Notas</th>
                    <th>Acci√≥n</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Rellenado por JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div> <!-- /modal-body -->
    </div> <!-- /modal-dialog -->
  </div> <!-- /modal-ficha -->
  <button id="btn-toggle-alta" class="fab-plus" type="button" aria-label="A√±adir ejemplar">+</button>
</body>
</html>

